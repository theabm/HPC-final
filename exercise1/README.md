# Exercise 1 - Conways Game of Life

Exercise 1 consists in the implementation of a scalable, hybrid MPI + OMP 
version of Conway's game of life. 

In particular, we have support for both *static* and *ordered* evolution. 

For detailed information, please read the full [description](https://github.com/Foundations-of-HPC/Foundations_of_HPC_2022/blob/main/Assignment/exercise1/Assignment_exercise1.pdf) of the 
assignment.

# Structure of this directory: 
```
data/all csv data files gathered during experiments 
scripts/all scripts used to gather data 
epyc_bin/binaries for EPYC nodes 
thin_bin/binaries for THIN nodes 
algo_2/source code, Makefile, and check.sh script for algorithm 2 
pattern_gifs/pattern videos generated with our code 
pattern_pgm/pgm patterns used to generate gifs and rle to pgm generator 
Makefile - to compile all source code 
conway_*.c - all source code for algorithm 1 
check.sh - bash script for automatic checking between all the implementations
*.pgm - patterns used for automatic checking

```
# Compile the code 

For all experiments, we used the openMPI library compiled against gnu 12.2.1. 

Using this library, to compile, simply the make command from the terminal:
```
$make
```
# Running the code
A thorough description can be found [here](https://github.com/Foundations-of-HPC/Foundations_of_HPC_2022/blob/main/Assignment/exercise1/Assignment_exercise1.pdf).

The following is a brief description.

1. To initialize a random grid of size $K$x$K$:
```
$mpirun -np P mpi_executable -i -f filename -k K 
```
or for non MPI executables: 
```
$./executable -i -f filename -k K 
```
2. To run static evolution for N steps and dump a snapshot with 
frequency S:
```
$mpirun -np P mpi_executable -r -f filename -n N -s S -e 1
```
Where P is the number of processes to be used. 

Be careful for hybrid versions as you may need to set the OMP_NUM_THREADS global 
variable to control the threads generated by each process.

For non MPI executables:
```
$./executable -r -f filename -n N -s S -e 1
```
Remember to set OMP_NUM_THREADS for OMP based implementations.

3. To run ordered evolution for N steps and dump a snapshot with
frequency S: 
```
$mpirun -np P mpi_executable -r -f filename -n N -s S -e 0
```
Where P is the number of processes to be used. 

In ordered evolution, hybrid implementations do not use OMP, so no need for 
extra attention.

For non MPI executables:
```
$./executable -r -f filename -n N -s S -e 0
```
Remember to set OMP_NUM_THREADS for OMP based implementations.

# How to generate gifs 
We use ffmpeg and mpv utilities to create and visualize the gifs. 

These can be obtained with: 
```
sudo apt install ffmpeg
sudo apt install mpv
```

To generate a gif, select the desired executable, the desired pattern, and run 
for a certain amount of evolutions, saving with a frequency of 1. 
For example, to generate the snark loop gif, using static evolution for 400 
iterations, execute the following commands: 
```
$mpirun -np 2 conway_hybrid_pgm.v2.out -r -f snark_loop_01.pgm -n 400 -s 1 -e 1
$ffmpeg -framerate 50 -f image2 -vcodec pgm -i snapshot_%05d snark_loop_video.mkv
$mpv snark_loop_video.mkv
```
